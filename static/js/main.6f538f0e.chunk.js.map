{"version":3,"sources":["App.js","array.js","index.js"],"names":["generateItems","length","Object","toConsumableArray","Array","keys","map","k","id","concat","text","opacity","actions","reverse","_ref","arr","items","slice","shuffle","_ref2","a","Math","random","sort","b","move","oldIndex","newIndex","_ref3","removeFrom","arguments","undefined","insertAt","isNaN","Number","_arr","item","splice","stopEvent","e","console","log","type","target","next","state","_ref4","_this","setState","swap","onDragOver","onDragStart","listRef","style","touchAction","setListRef","el","doSwap","index","findIndex","removeItem","_this2","this","react_default","createElement","className","droppable","onDrop","onClick","App_Draggable","ref","react_flip_move_es","onMoveEnd","enterAnimation","i","placeholder","App_ListItem","key","Component","Draggable","onTouchStart","touches","_e$target$getBounding","getBoundingClientRect","top","left","_this3","position","pointerEvents","props","onTouchEnd","document","elementFromPoint","changedTouches","clientX","clientY","onTouchMove","transform","zIndex","getAttribute","startPosition","draggable","ListItem","onMouseLeave","_this4","hide","_this$props","children","onPointerOut","ReactDOM","render","src_App_default","getElementById"],"mappings":"+OAMMA,eAAgB,SAAAC,GAAM,OAAIC,OAAAC,EAAA,EAAAD,CAAIE,MAAMH,GAAQI,QAAQC,IAAI,SAAAC,GAAC,MAAK,CAClEC,GAAE,QAAAC,OAASF,GACXG,KAAI,QAAAD,OAASF,GACbI,QAAQ,OAGJC,EAAU,CACdC,QAAS,SAAAC,GAAA,ICUYC,EDVVC,EAAFF,EAAEE,MAAF,MAAc,CAACA,OCUHD,EDVkBC,ECUXD,EAAIE,QAAQJ,aDTxCK,QAAS,SAAAC,GAAA,ICIYJ,EDJVC,EAAFG,EAAEH,MAAF,MAAc,CAACA,OCIHD,EDJkBC,ECIXD,EACzBT,IAAI,SAAAc,GAAC,MAAI,CAACC,KAAKC,SAAUF,KACzBG,KAAK,SAACH,EAAGI,GAAJ,OAAUJ,EAAE,GAAKI,EAAE,KACxBlB,IAAI,SAAAc,GAAC,OAAIA,EAAE,QDNdK,KAAM,SAACC,EAAUC,GAAX,OAAwB,SAAAC,GAAA,MAAc,CAACZ,MCf3B,SAACD,GAAwC,IAAnCc,EAAmCC,UAAA7B,OAAA,QAAA8B,IAAAD,UAAA,GAAAA,UAAA,GAAxB,KAAME,EAAkBF,UAAA7B,OAAA,QAAA8B,IAAAD,UAAA,GAAAA,UAAA,GAAT,KAKhD,GAAIE,IAAaH,EAAY,OAAOd,EACpC,GAAIkB,MAAMC,OAAOL,IAAeI,MAAMC,OAAOF,KAAa,OAAOjB,EAEjE,IAAIoB,EAAIjC,OAAAC,EAAA,EAAAD,CAAOa,GAETqB,EAAuB,OAAfP,EAAuBM,EAAKE,OAAOR,EAAY,GAAG,GAAK,KAKrE,OAJiB,OAAbG,GACAG,EAAKE,OAAOL,EAAU,EAAGI,GAGtBD,EDA2CV,CAAtBG,EAAEZ,MAAgCU,EAAUC,OAGtEW,EAAY,SAAAC,GAChBC,QAAQC,IAAI,gBAAgBF,EAAEG,KAAMH,EAAEI,SAKpCC,EAAO,+MAGTC,MAAQ,CAAE7B,MAAOhB,EAAc,OAE/ByB,KAAO,SAAAqB,GAAA,IAAEpB,EAAFoB,EAAEpB,SAAUC,EAAZmB,EAAYnB,SAAZ,OAA0BoB,EAAKC,SAASpC,EAAQa,KAAKC,EAAUC,OACtEd,QAAU,kBAAMkC,EAAKC,SAASpC,EAAQC,YACtCK,QAAU,kBAAM6B,EAAKC,SAASpC,EAAQM,YACtC+B,KAAO,SAACzC,GACN,IAAMQ,EAAQ+B,EAAKF,MAAM7B,MAAMC,QACzBmB,EAAOpB,EAAM4B,GACnB5B,EAAM4B,GAAQ5B,EAAM4B,EAAK,GACzB5B,EAAM4B,EAAK,GAAKR,EAChBW,EAAKC,SAAS,CAAChC,UACf4B,OAEFM,WAAa,kBAAMV,QAAQC,IAAI,iBAC/BU,YAAc,WACZX,QAAQC,IAAI,cAAeM,EAAKK,QAAQC,OACxCN,EAAKK,QAAQC,MAAMC,YAAY,UAGjCC,WAAa,SAAAC,GACXT,EAAKK,QAAUI,EACfhB,QAAQC,IAAIM,EAAKK,YAEnBK,OAAS,SAAAjD,GACP,IAAMQ,EAAQ+B,EAAKF,MAAM7B,MAAMC,QAC/BuB,QAAQC,IAAIzB,GACZ,IAAM0C,EAAQ1C,EAAM2C,UAAU,SAACvB,GAAD,OAAUA,EAAK5B,KAAOA,IACpDgC,QAAQC,IAAIjC,EAAIkD,GAChB,IAAME,EAAa5C,EAAM,GACzBA,EAAM,GAAKA,EAAM0C,GACjB1C,EAAM0C,GAASE,EACfb,EAAKC,SAAS,CAAChC,mFAER,IAAA6C,EAAAC,KACC9C,EAAU8C,KAAKjB,MAAf7B,MACR,OACE+C,EAAA3C,EAAA4C,cAAA,OAAKC,UAAU,MAAOC,UAAU,OAAQhB,WAAYY,KAAKZ,WAAYiB,OAAQL,KAAKZ,YAChFa,EAAA3C,EAAA4C,cAAA,UAAQI,QAASN,KAAKjD,SAAtB,WACAkD,EAAA3C,EAAA4C,cAAA,UAAQI,QAASN,KAAK5C,SAAtB,WACA6C,EAAA3C,EAAA4C,cAACK,EAAD,CAAWlB,YAAaW,KAAKX,YAAaF,KAAMa,KAAKb,OACrDc,EAAA3C,EAAA4C,cAAA,OAAKC,UAAU,OAAOK,IAAKR,KAAKP,YAC9BQ,EAAA3C,EAAA4C,cAACO,EAAA,EAAD,CAAUC,UAAWV,KAAKrC,KAAMgD,eAAe,QAC5CzD,EAAMV,IAAI,SAAC8B,EAAMsC,GAChB,IAAMC,EAAcvC,EAAK1B,OAAS,QAAUkC,EAC5C,OAAOmB,EAAA3C,EAAA4C,cAACY,EAAD,CAAUpE,GAAI4B,EAAK5B,GAAImE,YAAaA,EAAa1B,KAAMY,EAAKZ,KAAM4B,IAAKzC,EAAK5B,IAAK4B,EAAK1B,kBA9C9EoE,aAwDvBC,6MACJlC,MAAQ,CAACrC,GAAG,KACZwE,aAAe,SAAAzC,GACbC,QAAQC,IAAI,eAAgBF,EAAE0C,QAAS1C,EAAEI,OAAOU,OAD9B,IAAA6B,EAEE3C,EAAEI,OAAOwC,wBAAtBC,EAFWF,EAEXE,IAAKC,EAFMH,EAENG,KACZC,EAAKC,SAAW,CAACH,MAAKC,QACtB7C,QAAQC,IAAI6C,EAAKC,UACjBhD,EAAEI,OAAOU,MAAMmC,cAAgB,OAC/BF,EAAKG,MAAMtC,iBAGbuC,WAAa,SAAAnD,GACXA,EAAEI,OAAOU,MAAMmC,cAAgB,GAC/BhD,QAAQC,IAAI,cACZD,QAAQC,IAAIkD,SAASC,iBAAiBrD,EAAEsD,eAAe,GAAGC,QAASvD,EAAEsD,eAAe,GAAGE,UACvFT,EAAKG,MAAMxC,KAAKqC,EAAK9E,OAGvBwF,YAAc,SAAAzD,GACZD,EAAUC,GACVC,QAAQC,IAAI,cAAeF,EAAEI,QAE7BJ,EAAEI,OAAOU,MAAM4C,UAAf,kBAAAxF,OAA6C8B,EAAE0C,QAAQ,GAAGc,QAAQT,EAAKC,SAASH,IAAhF,OACA7C,EAAEI,OAAOU,MAAM6C,OAAS,MACxB,IAAM1F,EAAKmF,SAASC,iBAAiBrD,EAAE0C,QAAQ,GAAGa,QAASvD,EAAE0C,QAAQ,GAAGc,SAASI,aAAa,MAC9F3D,QAAQC,IAAIkD,SAASC,iBAAiBrD,EAAE0C,QAAQ,GAAGa,QAASvD,EAAE0C,QAAQ,GAAGc,UACzEvD,QAAQC,IAAIjC,GACRA,GAAO8E,EAAKzC,MAAMrC,KAAOA,GAAc,WAAPA,IAClC8E,EAAKG,MAAMxC,KAAKzC,GAChB8E,EAAKtC,SAAS,CAACxC,OACf8E,EAAK9E,GAAKA,MAGd4F,cAAgB,OAChBb,SAAW,2EAGT,OAAOxB,EAAA3C,EAAA4C,cAAA,OACHC,UAAU,cACVoC,UAAU,OACVL,YAAalC,KAAKkC,YAClBhB,aAAclB,KAAKkB,aACnBU,WAAY5B,KAAK4B,oBA1CDZ,aAgDlBwB,6MACJC,aAAe,SAAChE,GACdC,QAAQC,IAAI,eAAgB+D,EAAKf,MAAMjF,IACvCgG,EAAKf,MAAMxC,KAAKuD,EAAKf,MAAMjF,OAE7B0C,WAAW,WACTV,QAAQC,IAAI,iBAEdgE,KAAO,WAELD,EAAKf,MAAMxC,KAAKuD,EAAKf,MAAMjF,6EAEpB,IAAAkG,EAC+B5C,KAAK2B,MAAnCkB,EADDD,EACCC,SAAuBnG,GADxBkG,EACW/B,YADX+B,EACwBlG,IAE/B,OAAOuD,EAAA3C,EAAA4C,cAAA,OACLC,UAAe,UAAJzD,EAAe,QAAU,YACpCA,GAAIA,EAAI0D,UAAU,OAAOhB,WAAYY,KAAKZ,WAAYkB,QAASN,KAAK2C,KAAMG,aAAc9C,KAAKyC,cAAsB,WAAP/F,GAAmBmG,UAjB9G7B,aE7HvB+B,IAASC,OAAO/C,EAAA3C,EAAA4C,cAAC+C,EAAD,MAASpB,SAASqB,eAAe","file":"static/js/main.6f538f0e.chunk.js","sourcesContent":["import React, { Component, PureComponent } from 'react';\r\nimport FlipMove from 'react-flip-move';\r\nimport './App.css';\r\nimport { move, shuffle, reverse } from './array';\r\nimport { transform } from 'async';\r\n\r\nconst generateItems = length => [...Array(length).keys()].map(k => ({\r\n  id:`Item ${k}`,\r\n  text:`Item ${k}`,\r\n  opacity:1\r\n}));\r\n\r\nconst actions = {\r\n  reverse: ({items}) => ({items: reverse(items)}),\r\n  shuffle: ({items}) => ({items: shuffle(items)}),\r\n  move: (oldIndex, newIndex) => ({items}) => ({items: move(items, oldIndex, newIndex)}),\r\n}\r\n\r\nconst stopEvent = e => {\r\n  console.log('stoppingEvent',e.type, e.target);\r\n  // e.preventDefault();\r\n  // e.stopPropagation();\r\n}\r\n\r\nlet next = 0;\r\nexport default class extends Component {\r\n\r\n  state = { items: generateItems(80) }\r\n  \r\n  move = ({oldIndex, newIndex}) => this.setState(actions.move(oldIndex, newIndex));\r\n  reverse = () => this.setState(actions.reverse);\r\n  shuffle = () => this.setState(actions.shuffle);\r\n  swap = (id) => {\r\n    const items = this.state.items.slice();\r\n    const item = items[next];\r\n    items[next] = items[next+1];\r\n    items[next+1] = item;\r\n    this.setState({items});\r\n    next++;\r\n  }\r\n  onDragOver = () => console.log(\"onDragOver\");\r\n  onDragStart = () => {\r\n    console.log('onDragStart', this.listRef.style);\r\n    this.listRef.style.touchAction='none';\r\n\r\n  }\r\n  setListRef = el => {\r\n    this.listRef = el;\r\n    console.log(this.listRef);\r\n  }\r\n  doSwap = id => {\r\n    const items = this.state.items.slice();\r\n    console.log(items);\r\n    const index = items.findIndex((item) => item.id === id);\r\n    console.log(id, index);\r\n    const removeItem = items[0];\r\n    items[0] = items[index];\r\n    items[index] = removeItem;\r\n    this.setState({items})\r\n  }\r\n  render() {\r\n    const { items } = this.state;\r\n    return (\r\n      <div className=\"App\"  droppable=\"true\"  onDragOver={this.onDragOver} onDrop={this.onDragOver} >\r\n        <button onClick={this.reverse}>Reverse</button>\r\n        <button onClick={this.shuffle}>Shuffle</button>\r\n        <Draggable onDragStart={this.onDragStart} swap={this.swap}/>\r\n        <div className=\"list\" ref={this.setListRef}>\r\n          <FlipMove onMoveEnd={this.move} enterAnimation=\"fade\" >\r\n            {items.map((item, i) => {\r\n              const placeholder = item.text === 'Item ' + next;\r\n              return <ListItem id={item.id} placeholder={placeholder} swap={this.swap} key={item.id}>{item.text}</ListItem>\r\n            })}\r\n          </FlipMove>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\nclass Draggable extends Component {\r\n  state = {id:0}\r\n  onTouchStart = e => {\r\n    console.log(\"onTouchStart\", e.touches, e.target.style);\r\n    const {top, left} = e.target.getBoundingClientRect();\r\n    this.position = {top, left};\r\n    console.log(this.position) ;\r\n    e.target.style.pointerEvents = 'none';\r\n    this.props.onDragStart();\r\n  }\r\n\r\n  onTouchEnd = e => {\r\n    e.target.style.pointerEvents = '';\r\n    console.log('onTouchEnd');\r\n    console.log(document.elementFromPoint(e.changedTouches[0].clientX, e.changedTouches[0].clientY));\r\n    this.props.swap(this.id);\r\n  }\r\n\r\n  onTouchMove = e => {\r\n    stopEvent(e);                 \r\n    console.log(\"onTouchMove\", e.target);\r\n    // e.target.style.transform = `translate(${e.touches[0].clientX-this.position.left}px, ${e.touches[0].clientY-this.position.top}px)`;    \r\n    e.target.style.transform = `translate(0px, ${e.touches[0].clientY-this.position.top}px)`;    \r\n    e.target.style.zIndex = '999';\r\n    const id = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY).getAttribute(\"id\"); \r\n    console.log(document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY));\r\n    console.log(id);\r\n    if (id && (this.state.id !== id) && id !== \"Item 0\") {\r\n      this.props.swap(id);\r\n      this.setState({id});\r\n      this.id = id;\r\n    }\r\n  }\r\n  startPosition = null;\r\n  position = {};\r\n\r\n  render() {\r\n    return <div \r\n        className=\"placeholder\" \r\n        draggable=\"true\" \r\n        onTouchMove={this.onTouchMove}  \r\n        onTouchStart={this.onTouchStart}\r\n        onTouchEnd={this.onTouchEnd}\r\n      />\r\n  }\r\n}\r\n\r\n// FlipMove requires class compoonents as children\r\nclass ListItem extends Component {\r\n  onMouseLeave = (e) => {\r\n    console.log('onMouseLeave', this.props.id);\r\n    this.props.swap(this.props.id);\r\n  }\r\n  onDragOver=() => {\r\n    console.log(\"onDragOver\");\r\n  }\r\n  hide = () => {\r\n    // this.setState({opacity:0});\r\n    this.props.swap(this.props.id);\r\n  }\r\n  render() {\r\n    const { children, placeholder, id } = this.props;\r\n    const className = placeholder ? 'placeholder' : 'list-item'\r\n    return <div \r\n      className={id==\"Item 0\" ? 'blank' : 'list-item' }\r\n      id={id} droppable=\"true\" onDragOver={this.onDragOver} onClick={this.hide} onPointerOut={this.onMouseLeave}>{id !== \"Item 0\" && children}</div>\r\n  }\r\n}\r\n","export const move = (arr, removeFrom=null, insertAt=null) => {\r\n    /*\r\n        Adds item if removeFrom is null\r\n        Removes item if insertAt is null\r\n    */\r\n    if (insertAt === removeFrom) return arr;\r\n    if (isNaN(Number(removeFrom) || isNaN(Number(insertAt)))) return arr;\r\n\r\n    let _arr = [...arr];\r\n\r\n    const item = (removeFrom !== null) ? _arr.splice(removeFrom, 1)[0] : null; \r\n    if (insertAt !== null) {\r\n        _arr.splice(insertAt, 0, item);\r\n    }\r\n\r\n    return _arr;\r\n  };\r\n    \r\nexport const shuffle = arr => arr\r\n    .map(a => [Math.random(), a])\r\n    .sort((a, b) => a[0] - b[0])\r\n    .map(a => a[1]);\r\n\r\nexport const reverse = arr => arr.slice().reverse();","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}